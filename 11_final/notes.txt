Работа в БД развернутой локалько (с прошлых занятий): БД - avia, схема - bookings
Не использовал переменные среды для настройки подключения к БД, выбору схемы и т.д. Хотя в прод-средах это, безусловно, обязательное условие.
Dimension lookup|update работал медленно и не получилось повысить скорость работы. Поэтому исползовался другой, более топорный, подход к обновлению измерений.
Не смотря на то, что процедуры обновления измерений похожи, я не использовал metadata injection или вложенные трансформации, т.к. объем достаточно маленький. Для прода или при бОльшем количестве измерений это целесообразно.
Маленькие таблицы измерений (таифы, самолеты, аэропорты) подключены через lookup с полным кешированием и загрузкой таблиц в память.
Все время выполнения job на моем стенде занимает около 1 минуты.